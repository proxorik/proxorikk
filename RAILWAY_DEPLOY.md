# Инструкция по деплою Cookie AI на Railway

Эта инструкция поможет вам развернуть вашего Telegram бота Cookie AI на платформе Railway для работы 24/7.

## Предварительные требования

1. Аккаунт на [Railway](https://railway.app/) (можно зарегистрироваться через GitHub)
2. Telegram Bot Token (получить у [@BotFather](https://t.me/BotFather))
3. OpenAI API Key (получить в [OpenAI Dashboard](https://platform.openai.com/api-keys))

## Шаги для деплоя

### 1. Подготовка проекта

Проект уже подготовлен для деплоя на Railway:
- Dockerfile настроен для создания контейнера
- railway-requirements.txt содержит все необходимые зависимости
- Procfile указывает команду для запуска бота
- Бот настроен для автоматического перезапуска в случае ошибок

### 2. Создание проекта на Railway

1. Зайдите на [Railway](https://railway.app/) и войдите в аккаунт
2. Нажмите кнопку "New Project"
3. Выберите "Deploy from GitHub repo"
4. Выберите репозиторий с вашим ботом (или склонируйте этот репозиторий в ваш GitHub аккаунт)

### 3. Настройка переменных окружения

1. В панели проекта Railway перейдите на вкладку "Variables"
2. Добавьте следующие переменные окружения:
   - `TELEGRAM_TOKEN` - ваш токен от BotFather
   - `OPENAI_API_KEY` - ваш API ключ от OpenAI
   - `PORT` - установите значение "8080" для работы keep-alive сервера

### 4. Настройка деплоя

#### Вариант 1: Автоматический деплой через Dockerfile

Railway автоматически обнаружит Dockerfile в корне проекта и использует его для создания контейнера.

1. Перейдите во вкладку "Settings" вашего проекта
2. В разделе "Deploy" убедитесь, что выбран "Docker" как стратегия развертывания
3. Railway автоматически построит и запустит контейнер

#### Вариант 2: Деплой через Procfile

Вы также можете использовать Procfile для деплоя без Docker:

1. Переименуйте `railway-requirements.txt` в `requirements.txt`
   ```bash
   mv railway-requirements.txt requirements.txt
   ```
2. В настройках проекта "Settings" убедитесь, что в "Start Command" указано: `python bot.py`

### 5. Мониторинг и управление

После деплоя:

1. Перейдите во вкладку "Deployments", чтобы увидеть статус деплоя
2. Во вкладке "Logs" вы можете просматривать логи работы бота
3. Команда `/status` в вашем боте показывает актуальную информацию о его работе

### Важные замечания

1. Railway предоставляет бесплатные часы использования ежемесячно. Для работы 24/7 потребуется платный план
2. Бот настроен на автоматический перезапуск при ошибках, но стоит регулярно проверять его состояние
3. Флаг `PYTHONUNBUFFERED=1` в Dockerfile обеспечивает корректный вывод логов в Railway

## Устранение неполадок

1. **Бот не запускается**: Проверьте логи в Railway для выявления ошибок
2. **Ошибки подключения к Telegram API**: Убедитесь, что токен бота верен и активен
3. **Проблемы с OpenAI API**: Проверьте баланс и статус вашего API ключа OpenAI
4. **Контейнер перезагружается**: Проверьте логи на наличие ошибок кода или нехватки ресурсов
5. **Бот перестает отвечать**: Команда `/status` поможет проверить статус бота и его метрики

## Обновление бота

Для обновления бота, просто внесите изменения в GitHub репозиторий. Railway автоматически обнаружит изменения и запустит новый деплой.